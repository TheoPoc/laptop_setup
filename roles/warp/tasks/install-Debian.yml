---
- name: Install Warp terminal (Debian/Ubuntu)
  when:
    - warp_enabled | bool
    - not ansible_check_mode
  block:
    - name: Download Warp DEB package
      ansible.builtin.get_url:
        url: "{{ warp_deb_url }}"
        dest: "/tmp/warp-terminal.deb"
        mode: "0644"
      register: warp_deb_download

    - name: Install Warp DEB package
      ansible.builtin.apt:
        deb: "/tmp/warp-terminal.deb"
        state: "{{ warp_apt_state }}"
      become: true
      register: warp_apt_result
  rescue:
    - name: Clean up downloaded DEB package
      ansible.builtin.file:
        path: "/tmp/warp-terminal.deb"
        state: absent
