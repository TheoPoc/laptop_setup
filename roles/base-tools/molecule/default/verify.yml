---
- name: Verify
  hosts: all
  gather_facts: true
  tasks:
    - name: Check if git is installed
      ansible.builtin.command: which git
      register: git_installed
      changed_when: false
      failed_when: git_installed.rc != 0

    - name: Check if python3 is installed
      ansible.builtin.command: which python3
      register: python_installed
      changed_when: false
      failed_when: python_installed.rc != 0

    - name: Check if curl is installed
      ansible.builtin.command: which curl
      register: curl_installed
      changed_when: false
      failed_when: curl_installed.rc != 0

    - name: Check if wget is installed
      ansible.builtin.command: which wget
      register: wget_installed
      changed_when: false
      failed_when: wget_installed.rc != 0

    - name: Check if unzip is installed
      ansible.builtin.command: which unzip
      register: unzip_installed
      changed_when: false
      failed_when: unzip_installed.rc != 0

    - name: Check if jq is installed
      ansible.builtin.command: which jq
      register: jq_installed
      changed_when: false
      failed_when: jq_installed.rc != 0

    - name: Verify all essential packages are installed
      ansible.builtin.assert:
        that:
          - git_installed.rc == 0
          - python_installed.rc == 0
          - curl_installed.rc == 0
          - wget_installed.rc == 0
          - unzip_installed.rc == 0
          - jq_installed.rc == 0
        fail_msg: "Some essential packages are not installed"
        success_msg: "All essential packages are installed successfully"
